/// Applies a fade-in effect to <img> and <picture> elements
///
/// @param {String} $targetClass
@mixin oLazyLoadImage ($targetClass: 'o-lazy-load') {
	// Apply fade-in effect only to <img> and <picture> elements
	img.#{$targetClass},
	picture.#{$targetClass} {
		opacity: 0;
		transition: opacity 0.25s;
		will-change: opacity;

		&[data-o-lazy-load] {
			opacity: 1;
		}
	}
}

/// Creates a placeholder to preserve space for lazy loaded content
///
/// @param {String} $placeholderClass
/// @param {String} $targetClass
@mixin oLazyLoadPlaceholder ($placeholderClass: 'o-lazy-load-placeholder', $targetClass: 'o-lazy-load') {
	.#{$placeholderClass} {
		position: relative;

		.#{$targetClass} {
			position: absolute;
			top: 0;
			left: 0;
			// Images have implicit sizes so this forces them to fit the placeholder
			width: 100%;
			height: 100%;
			// IntersectionObserver requires a non-zero height
			min-height: 1px;
		}

		&:after {
			content: '';
			display: block;
		}
	}

	@each $ratio in $o-lazy-load-placholder-ratios {
		$x: nth($ratio, 1);
		$y: nth($ratio, 2);

		.#{$placeholderClass}--#{$x}\:#{$y} {
			&:after {
				padding-bottom: percentage(1 / $x * $y);
			}
		}
	}
}
